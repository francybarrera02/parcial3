//- views/medicos.pug

extends layout

block content
  .pacientes-container
    //- TÃ­tulo
    h1 Lista de MÃ©dicos

    //
    // â–¸ FORMULARIO DE BÃšSQUEDA
    //
    form(method='GET', action='/medicos', style='margin-bottom: 20px; text-align: right;')
      input(
        type='text'
        name='search'
        placeholder='Buscar mÃ©dico...'
        value=search
        style='padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; width: 200px;'
      )
      button(type='submit', style='margin-left: 8px; padding: 8px 12px; background:#6c9eff; color:white; border:none; border-radius:4px; cursor:pointer;') ðŸ”
      if search
        a(
          href='/medicos'
          style='margin-left: 10px; color: #dc3545; font-weight: bold; text-decoration: none;'
        ) Limpiar

    //
    // â–¸ TABLA DE MÃ‰DICOS
    //
    if medicos.length
      table.pacientes-table
        thead
          tr
            th Nombre
            th Especialidad
            th Acciones
        tbody
          each medico in medicos
            tr
              td= medico.nombre
              td= medico.especialidad
              td
                //- Icono Eliminar
                a(
                  href=`/medicos/eliminar/${medico.id}`
                  title='Eliminar'
                  style='margin-right: 12px; color: #dc3545; text-decoration: none; font-size: 18px;'
                  onclick="return confirm('Â¿Seguro que deseas eliminar a este mÃ©dico?');"
                ) ðŸ—‘ï¸
                //- Icono Editar (redirige aÃ±adiendo ?edit=id al mismo controlador)
                a(
                  href=`/medicos?search=${search || ''}&page=${currentPage}&edit=${medico.id}`
                  title='Editar'
                  style='color: #007bff; text-decoration: none; font-size: 18px;'
                ) âœï¸

      //
      // â–¸ CONTROLES DE PAGINACIÃ“N
      //
      .pagination
        //- BotÃ³n â€œAnteriorâ€
        if currentPage > 1
          a(
            href=`/medicos?search=${search || ''}&page=${currentPage - 1}`
          ) Â« Anterior
        else
          span(style='opacity: 0.5; cursor: default;') Â« Anterior

        //- Botones de pÃ¡gina numÃ©rica
        - for (let num = 1; num <= totalPages; num++)
          if num === currentPage
            span= num
          else
            a(
              href=`/medicos?search=${search || ''}&page=${num}`
            )= num

        //- BotÃ³n â€œSiguienteâ€
        if currentPage < totalPages
          a(
            href=`/medicos?search=${search || ''}&page=${currentPage + 1}`
          ) Siguiente Â»
        else
          span(style='opacity: 0.5; cursor: default;') Siguiente Â»

    else
      p No hay mÃ©dicos registrados.

    //
    // â–¸ FORMULARIO ÃšNICO DE REGISTRO / EDICIÃ“N
    //
    h2= medicoEdit ? 'Editar MÃ©dico' : 'Registrar MÃ©dico'

    form.formulario-paciente(
      action= medicoEdit
        ? `/medicos/actualizar/${medicoEdit.id}`
        : '/medicos/registrar'
      method='POST'
    )
      .form-group
        label(for='nombre') Nombre:
        input(
          type='text'
          name='nombre'
          required
          value= medicoEdit ? medicoEdit.nombre : ''
          placeholder='Nombre del mÃ©dico'
        )

      .form-group
        label(for='especialidad') Especialidad:
        input(
          type='text'
          name='especialidad'
          required
          value= medicoEdit ? medicoEdit.especialidad : ''
          placeholder='Especialidad del mÃ©dico'
        )

      //- BotÃ³n envÃ­a â€œRegistrarâ€ o â€œActualizarâ€ segÃºn contexto
      button(
            type='submit',
            style='background-color: #6c9eff; color: white; padding: 10px 0; width: 80%; border: none; border-radius: 8px; margin-top: 15px; font-size: 16px; font-weight: bold; cursor: pointer; display: block; margin-left: auto; margin-right: auto;'
        )= medicoEdit ? 'Actualizar' : 'Registrar MÃ©dico'

      //- Si estamos editando, botÃ³n para cancelar ediciÃ³n y volver a modo â€œRegistrarâ€
      if medicoEdit
        .text-center
          a(
            href=`/medicos?search=${search || ''}&page=${currentPage}`
            style='display:inline-block; margin-top: 12px; color: #dc3545; font-size: 14px; text-decoration: none;'
          ) Cancelar ediciÃ³n

    .text-center.mt-4
      p.text-muted Ingrese los datos del mÃ©dico para registrarlo o editarlo en el sistema.
    .text-center.mt-4